"use strict";function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,o,r,n,a,i){try{var s=e[a](i),l=s.value}catch(u){return void o(u)}s.done?t(l):Promise.resolve(l).then(r,n)}function _asyncToGenerator(e){return function(){var t=this,o=arguments;return new Promise(function(r,n){function a(e){asyncGeneratorStep(s,r,n,a,i,"next",e)}function i(e){asyncGeneratorStep(s,r,n,a,i,"throw",e)}var s=e.apply(t,o);a(void 0)})}}define("js/share/constants",[],function(){return{widgetVersion:{REACT:2,REACT_WRAPPER:1}}}),define("browserSupport",["bowser","modernizr"],function(e){var t=function(){var t={init:function(){if(window.isBrowserGraylisted&&!window.browserSupportIgnored){var e=t.checkIsNotOldSchool();e&&(e=t.checkIsNotMobile()),e&&t.checkHasFeatures()}},checkIsNotOldSchool:function(){var e;return[].forEach?e=!0:(e=!1,window.location.href="/browser_support_fail"),e},checkIsNotMobile:function(){var o,r=!1,n=[];return(e.tablet||e.mobile)&&(r=!0,n.push("mobile or tablet device")),r?(console.log("browser support errors: "+JSON.stringify(n)),o=!1,require(["i18n"],function(e){t.showModal(e("all.not optimized for mobile devices"),e("all.for stable workflow use desktop computer")+'<p style="text-align: center;margin-top: 20px;"><img src="/img/laptop.png"></p>',e("all.continue anyway"))})):o=!0,o},checkHasFeatures:function(){var e,o=!1,r=[],n=window.Modernizr;for(var a in n)"boolean"==typeof n[a]&&0==n[a]&&(o=!0,r.push(a));return o?(console.log("browser support errors: "+JSON.stringify(r)),e=!0,require(["i18n","text!/html/constructor/browserSupport.html","css!/css/browserSupport.css"],function(e,o){t.showModal(e("all.your browser not supported yet"),e("all.for stable workflow we recommend")+o,e("all.continue anyway"))})):e=!1,e},showModal:function(e,t,o){require(["nf"],function(r){r.confirm({title:e,text:t,ok:o,okCb:function(){window.location.href=window.location.href+"?ignoreBrowserSupport=true"}})})}};return{init:t.init}}();return t}),define("loadIconSprite",["jquery","U"],function(e,t){return{init:function(){function o(){return r.apply(this,arguments)}var r=_asyncToGenerator(regeneratorRuntime.mark(function n(){var o,r,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=null,r=t.params.ukitIconSpriteUrl,!document.getElementById("ukit-icon-sprite")){n.next=4;break}return n.abrupt("return");case 4:return n.prev=4,n.next=7,e.ajax({url:r,outerApiRequest:!0,doNotShowAjaxError:!0});case 7:o=n.sent,n.next=14;break;case 10:return n.prev=10,n.t0=n["catch"](4),console.log("Can't load sprite"),n.abrupt("return");case 14:a=e('<div id="ukit-icon-sprite" style="display: none;"></div>'),a.append(e(o).children()),e("body").append(a);case 17:case"end":return n.stop()}},n,null,[[4,10]])}));return o}()}}),require(["js/share/constants","browserSupport","loadIconSprite","ul-error","core"],function(e,t,o){for(var r in e)e.hasOwnProperty(r)&&(window[r]=e[r]);t.init(),o.init(),require(["U","panel","panelDialog","page","ul-framework","nf","i18n","logActions","browser-id","projectCopyrightBanner","eventsStreamProducer"],function(e,t,o,r,n,a,i,s,l,u,c){window.UU=e,window.UU.menu=t,window.UU.page=r,t.init(),o.init({menu:t}),r.init(t),u.init();var d=new n.tooltip;if(d.init("[title]:not(iframe)"),window.checkAdblock||a.notify(i("constructor.adblock detected",window.location.host),"info",{timeout:15e3,actions:[]}),$(document).on("keydown",function(e){return 8===e.keyCode?!("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&!$(e.target).closest("[contenteditable]").length):void 0}),e.params.site&&e.params.pageId&&e.hist._init(function(){var t;return t=window.constructorPreviewMode?{data:{url:"/sites/url/"+e.params.site+"/pages/id/"+e.params.pageId+"/preview",panel:"panelPreview"},title:"preview",url:"/sites/url/"+e.params.site+"/pages/id/"+e.params.pageId+"/preview"}:{data:{url:"/sites/url/"+e.params.site+"/pages/id/"+e.params.pageId+"/edit"},title:"title",url:"/sites/url/"+e.params.site+"/pages/id/"+e.params.pageId+"/constructor"}}(),function(e){return e.panel?void t.setPanel(e.panel):($('.js-preview-action[data-mode="back"]',".ul-preview-mode").trigger("click"),void r.setPage(e.url))}),window.localStorage.backupRestoreMsg)try{var p=JSON.parse(window.localStorage.backupRestoreMsg);p.site==e.params.site&&setTimeout(function(){a.notify(i("constructor.backup restored")),delete window.localStorage.backupRestoreMsg},500)}catch(h){console.log(h)}if(!window.developmentMode){var g=!0,f=window.attachEvent||window.addEventListener,m=window.attachEvent?"onbeforeunload":"beforeunload";f(m,function(e){return g?((e||window.event).returnValue="Are you sure to leave the page",String((e||window.event).returnValue)):void 0}),document.addEventListener("mousedown",function(){g=!1}),document.addEventListener("disableUnloadAlert",function(){g=!1}),document.addEventListener("mouseup",function(){setTimeout(function(){g=!0},200)})}s.add({fromFile:"js/constructor/app.js",title:"constructor load",desc:"site: "+e.params.site+". pageId: "+e.params.pageId}),(new l).saveIdToCookie(),c.safetySend({event:"open constructor",eventVersion:"v1",context:{siteId:e.params.siteObjectId}})})}),define("js/constructor/app",function(){}),define("history",["U","waitall","asyncjs","enqueueAjax","jquery","i18n","nf","ul-error"],function(e,t,o,r,n,a,i,s){var l={title:a("all.oldPage")("title"),text:a("all.oldPage")("text"),ok:a("all.oldPage")("okBtnText"),okCb:function(){window.location.reload()}},u={title:a("all.ajaxError")("title"),text:a("all.ajaxError")("text"),ok:a("all.ajaxError")("okBtnText"),okCb:function(){window.location.reload()}},c={title:a("all.timeoutError")("title"),text:a("all.timeoutError")("text"),ok:a("all.timeoutError")("okBtnText"),okCb:function(){window.location.reload()}},d=function(e){return function(t){t.session_error?i.confirm(l):t.version_error?i.confirm(u):e.call(this,t)}};return{cursor:null,states:[],forwardStates:[],curAtomic:null,stackAtomic:0,actions:{},regAction:function(e,t){this.actions[t.act]={a:t,me:e}},animateState:function(e){var r=this;if(e.undo&&e.redo)return e;if("atomic"==e.act){var n=e.data,a=n.slice(0).reverse();return{id:e.id,server:!0,act:"atomic: "+n.map(function(e){return e.act}).join(","),undo:function(e){o.mapSeries(a,function(e,o){t(r.animateState(e).undo,o)},e())},redo:function(e){o.mapSeries(n,function(e,o){t(r.animateState(e).redo,o)},e())}}}var i=r.actions[e.act];return{id:e.id,server:!0,act:e.act,undo:function(t){return i.a.undo(i.me,e.data,t)},redo:function(t,o){return i.a.redo(i.me,e.data,t,o)}}},clearState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.states=[],this.forwardStates=[],e(),n(document).trigger("historyBtnsLight")},pageChanged:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.clearState(e)},pushState:function(e){return this.curAtomic?this.curAtomic.push(JSON.parse(JSON.stringify(e))):(this.send("push",e),this.states.push(this.animateState(e)),this.forwardStates.length>0&&(this.forwardStates=[]),void n(document).trigger("historyBtnsLight"))},pushAndExec:function(e,o){var r=this;this.beginAtomic(),this.pushState(e);var n=r.animateState(e);return t(function(e){return n.redo(e,!0)},function(){r.endAtomic(),o&&o()})},beginAtomic:function(){var e=this,t=e.stackAtomic;++e.stackAtomic,t||(r(null,{action:"beginAtomic"}),e.curAtomic=[])},endAtomic:function(){var e=this;if(--e.stackAtomic,!e.stackAtomic){var t=e.curAtomic;if(e.curAtomic=null,t.length){var o={act:"atomic",server:!0,data:t};e.send("push",o),e.states.push(e.animateState(o)),e.forwardStates.length>0&&(e.forwardStates=[]),n(document).trigger("historyBtnsLight")}r(null,{action:"endAtomic"})}},discardAtomic:function(){--this.stackAtomic,this.stackAtomic||(this.curAtomic=null,r(null,{action:"endAtomic"}))},queue:[],enqueue:function(e){var t=this,o=function(){e(function(){t.queue.shift(),t.queue.length&&t.queue[0]()})};t.queue.push(o),1==t.queue.length&&t.queue[0]()},asAtomic:function(e){this.beginAtomic(),e(),this.endAtomic()},undo:function(){var e=this;e.enqueue(function(o){if(0==e.states.length)return o();var r=e.states.pop();r.server&&e.send("push"),n(document).trigger("historyBtnsLight"),e.beginAtomic(),t(r.undo,function(){e.discardAtomic(),e.forwardStates.push(r),n(document).trigger("historyBtnsLight"),o()})})},redo:function(){var e=this;e.enqueue(function(o){if(0==e.forwardStates.length)return o();var r=e.forwardStates.pop();r.server&&e.send("push"),n(document).trigger("historyBtnsLight"),e.beginAtomic(),t(r.redo,function(){e.discardAtomic(),e.states.push(r),n(document).trigger("historyBtnsLight"),o()})})},sendQueue:o.queue(function(e,t){e(t)},1),send:function(t,o,l){var u=this;if(!u._stopQueue){var p=e.params.site,h=e.params.page,g=e.params.lastId,f=function(e){u.sendQueue.push(function(o){var r,f=0,m=10,v=function(e,t,o,n,a){return t>=e?(setTimeout(function(){r(e,t)},50*e),void++e):(i.confirm(c),u._stopQueue=!0,o(a),void(n&&n(a,null)))};(r=function(r,c){n.ajax({url:"/sites/url/"+p+"/pages/id/"+h+"/history/"+t+"?lastId="+g,type:"post",data:{dataFromAjaxEnqueue:JSON.stringify(e)},doNotShowAjaxError:!0}).success(d(function(t){return t[1]&&Array.isArray(t[1])?(o(null),l&&l(null,[t[0],t[1].shift()]),void e.forEach(function(e){if(e.data&&e.data.queries){var o=JSON.parse(e.data.queries)[0];o&&o.__sendCb&&n(document).trigger("sendPush-".concat(o.__sendCb),o)}var r=t[1].length?t[1].shift():null;e.cb&&e.cb(r.err,r.data)})):(u._stopQueue=!0,s.sendErrorOnServer({msg:"[History] Data 1 is not defined",data:t}),void i.confirm({title:a("all.ajaxError")("title"),text:a("all.ajaxError")("text"),ok:a("all.ajaxError")("okBtnText"),okCb:function(){window.location.reload()}}))})).error(function(e){c=504==e.status||408==e.status?c:0,v(r,c,o,l,e)})})(f,m)})};r(null,{action:"setCallBack",callBack:f,comand:t})}}}}),define("model/pages",["jquery","_","U"],function(e,t,o){return{pages:null,templateBlanks:null,copy:function(t,r,n,a){var i=this;e.ajax({url:"/sites/url/"+t+"/pages/id/"+r+"/copy",type:"GET",api:!0,ok:function(e){i.load(t,function(){i.pages.push(e.page),o.params.pages.push(e.page),n(e.page)})},noOk:function(e){a(e)},error:function(){require(["nf"],function(e){e.notify("Произошла ошибка","error")})}})},create:function(t,r,n,a){var i=this;e.ajax({url:"/sites/url/"+t+"/pages",type:"POST",data:r,api:!0,ok:function(e){null!==e?(o.params.pages.push(e.page),i.pages.push(e.page),n(e.page)):a(e)},noOk:function(e){a(e)},error:function(){require(["nf"],function(e){e.notify("Произошла ошибка","error")})}})},edit:function(t,r,n,a,i){var s=this;e.ajax({url:"/sites/url/"+t+"/pages/id/"+r,type:"POST",data:n,api:!0,ok:function(t){"index"===r&&(t.useCommonMetaImage=n.useCommonMetaImage,o.params.commonMetaImage=t.useCommonMetaImage?t.meta.image:""),e(s.pages).each(function(e,o){return o._id==n._id?(s.pages[e]=t,!1):void 0}),a(t)},noOk:function(e){i(e)},error:function(){require(["nf"],function(e){e.notify("Произошла ошибка","error")})}})},getPageBlank:function(e){return{_id:"",id:"",title:e||"Страница",template:"index",meta:{image:"",description:"",keywords:[]}}},get:function(e,t,o){var r=this;if(r.pages){var n=r.pages.filter(function(e){return e._id===t})[0];o(n)}else r.load(e,function(){var e=r.pages.filter(function(e){return e._id===t})[0];o(e)})},getPageBlanks:function(t,o){var r=this;r.templateBlanks?o(null,r.templateBlanks):e.get("/sites/url/"+t+"/templatePages").success(o.ok(function(e){r.templateBlanks=e.pages,o(null,r.templateBlanks)})).error(o)},load:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,n=this;return n.isPageDeleting?void setTimeout(function(){n.load(t,o)},50):!n.pages||r?e.ajax({url:"/sites/url/"+t+"/pages",type:"GET",api:!0,ok:function(e){return n.pages=e.pages.map(function(e){return e.type=e._type||"common",e}),o(n.pages),n.pages},noOk:function(e){throw e}}):(o(n.pages),[null,{pages:n.pages}])},remove:function(o,r,n){var a=this;a.isPageDeleting=!0,require(["nf"],function(i){e.ajax({url:"/sites/url/"+o+"/pages/id/"+r+"/delete",type:"POST",api:!0,ok:function(e){a.pages=t.reject(a.pages,function(e){return e.id==r}),n(e)},noOk:function(){i.notify("Произошла ошибка","error")},error:function(){i.notify("Произошла ошибка","error")}}).always(function(){a.isPageDeleting=!1})})},savePagesOrder:function(t,o,r){require(["nf"],function(n){e.ajax({url:"/sites/url/"+o+"/pages/order",type:"POST",api:!0,data:{order:t},ok:function(){r()},noOk:function(){n.notify("Произошла ошибка","error")},error:function(){n.notify("Произошла ошибка","error")}})})},saveProductOrder:function(t,o,r){require(["nf"],function(n){e.ajax({url:"/sites/url/"+o+"/pages/order/product",type:"POST",api:!0,data:{order:t},ok:function(){r()},noOk:function(){n.notify("Произошла ошибка","error")},error:function(){n.notify("Произошла ошибка","error")}})})},getAllPages:function(){return this.pages}}}),define("js/ulib/ulLoader/progressModel",[],function(){var e=function(e){this._estimate=1500/Math.max(2e3,e.estimate||2e3),this._formula=function(e){return.12*Math.log(e*this._estimate+1)},this._startTime=null,e.auto!==!1&&this.start()};return e.prototype={start:function(){this._startTime=Date.now()},stop:function(){this._startTime=null},get value(){if(null===this._startTime)return 0;var e=Date.now()-this._startTime;return Math.min(1,this._formula(e))}},e}),function(e){if("function"==typeof define&&define.amd)define("js/ulib/ulLoader/defaultOptions",[],e);else{if("object"!==("undefined"==typeof exports?"undefined":_typeof(exports)))throw new Error("Unexpected environment");module.exports=e()}}(function(){return{isBlurring:!1,isShowPanel:!1,isShowProgressBar:!1,img:!1,title:"constructor.title",text:"constructor.text"}}),define("page",["jquery","U","posFixed","nf","i18n","history","_","logActions","ulLoader","typography","colorThemeHelper"],function(e,t,o,r,n,a,i,s,l){var u=null,c={position:"",deny:!1,init:function(r){var n=this,a=this;u=r,a.intTopHandler=null,a.intBottomHandler=null,a.$dropTarget=null,a.$el=e("#ul-main"),window.signals.setPage.listen(function(e){return new Promise(function(t){n._realSetPage.apply(n,e),t()})}),a.setPage(t.params.pageUrl,function(){o.init("#ul-main"),a.doc=window.document,a.w=window,a.dragEl=!1,a.prevAbsSize={},a.top=a.$el.offset().top,a.left=a.$el.offset().left,a.width=a.$el.width(),a.height=a.$el.height(),e(a.$el).on("click","a",function(t){t.preventDefault();var o=e(t.target),r=o.attr("href");if(o.hasClass("ul-nav-link")){var n=r.split("/");r="/sites/url/"+n[1]+"/pages/id/"+n[2]+"/edit",a.setPage(r)}}),l.hide()})},getClosestEl:function(t,o,r){var n,a,i,s,l,u,c,d,p=this,h=null,g=[],f=!1,m=parseInt(p.$el.scrollTop()),v=parseInt(p.$el.scrollLeft());return e.each(r,function(e,r){var n={top:parseInt(r.top+m),left:parseInt(r.left+v),bottom:parseInt(r.height+r.top+m),right:parseInt(r.width+r.left+v)};t>=n.left&&t<=n.right&&o>=n.top&&o<=n.bottom&&(g.push(r.$el),h=r.$el)}),g.length?g.forEach(function(e){return e.hasClass("ul-widget")?(h=e,!1):void 0}):e.each(r,function(e,r){var p={top:parseInt(r.top+m),left:parseInt(r.left+v),bottom:parseInt(r.height+r.top+m),right:parseInt(r.width+r.left+v)};l=Math.max(t,p.left),u=Math.min(t,p.right),c=Math.max(o,p.top),d=Math.min(o,p.bottom),n=l-u,a=c-d,s=Math.sqrt(n*n+a*a),!(void 0==i||i>s)||r.$el.hasClass("ul-drop-remove")||r.$el.is("header")||r.$el.is("footer")||(i=s,f=!0,h=r.$el)}),{$el:h,scrollTop:m,scrollLeft:v,isOuter:f}},closestToCoords:function(e,t){if(!t||!t.length)return null;var o=this,r=null,n=parseInt(e.left+o.$el.scrollLeft()),a=parseInt(e.top+o.$el.scrollTop()),i={},s=null,l=15;if(i=o.getClosestEl(n,a,t),r=i.$el,!r||!r.length||!r.offset())return r&&!r.offset()&&require(["ul-error"],function(e){e.sendErrorOnServer({msg:"UKT-5404 closestToCoords. $el.offset underfined.",dragEl:r,dragEllength:r.length,elFind:i,$collection:t})}),null;if(r.hasClass("ul-drop-remove")||r.hasClass("ul-drop-placeholder"))return r;if(!r.hasClass("ul-container"))var u=r.closest(".ul-row").length?Math.abs(r.closest(".ul-row").offset().top+i.scrollTop-a):!1,c=r.closest(".ul-row").length?Math.abs(r.closest(".ul-row").offset().top+i.scrollTop+r.closest(".ul-row").height()-a):!1,d=r.closest(".ul-row").length?Math.abs(r.closest(".ul-row").offset().left+i.scrollLeft-n):!1,p=r.closest(".ul-row").length?Math.abs(r.closest(".ul-row").offset().left+i.scrollLeft+r.closest(".ul-row").width()-n):!1;if(!r.is("header")&&!r.hasClass("ul-drop-remove")&&!r.is("footer")){(!r.hasClass("ul-container")&&"top"==o.position&&l>=u||"bottom"==o.position&&l>=c||"bottom"==o.position&&l>=u||"top"==o.position&&l>=c)&&(r=r.closest(".ul-row")),s={top:parseInt(r.offset().top+i.scrollTop),left:parseInt(r.offset().left+i.scrollLeft),bottom:parseInt(r.height()+r.offset().top+i.scrollTop),right:parseInt(r.width()+r.offset().left+i.scrollLeft)};var h=Math.abs(s.left-n),g=Math.abs(s.right-n),f=Math.abs(s.top-a),m=Math.abs(s.bottom-a);if(i.isOuter)p>d?c>u?d>u?o.position="top":o.position="left":d>c?o.position="bottom":o.position="left":d>p&&(m>u?p>u?o.position="top":o.position="right":p>c?o.position="bottom":o.position="right"),(u&&c&&"top"==o.position&&l>=u||"bottom"==o.position&&l>=c||i.isOuter)&&(r="left"==o.position||"right"==o.position?r.closest(".ul-col"):r.closest(".ul-row"));else{g>h?m>f?h>f?o.position="top":o.position="left":h>m?o.position="bottom":o.position="left":h>g&&(m>f?g>f?o.position="top":o.position="right":g>m?o.position="bottom":o.position="right");var v=null;r.hasClass("ul-col")&&r.children(".ul-widget").length&&(v=Math.abs(r.children(".ul-widget").last().offset().top+r.children(".ul-widget").last().height()+i.scrollTop-a),m>v&&h>v&&g>v&&(r=r.children(".ul-widget").last(),o.position="bottom"))}}return r},closestToCoordsAbs:function(e,t){if(!t.length)return null;var o=this,r=parseInt(e.left+o.$el.scrollLeft()),n=parseInt(e.top+o.$el.scrollTop());return o.getClosestEl(r,n,t,null).$el},content:function(){var e=this;return e.$el.content()},dropCollectionToOffsetObjects:function(){var t=c;t.$droppableCollection=e(t.$droppableCollection).map(function(e,t){return{$el:t.$el,top:parseInt(t.$el.offset().top),left:parseInt(t.$el.offset().left),height:parseInt(t.$el.outerHeight()),width:parseInt(t.$el.outerWidth())}})},deselectDroppable:function(){var t=this;t.ulDropSetDeny(!1),e(".ul-absolute-widgets").removeClass("ul-drop-absolute-hover"),e(".ul-fake-drop-position-absolute").removeClass("ul-drop-absolute-hover"),e(".ul-drop-top").removeClass("ul-drop-top"),e(".ul-drop-bottom").removeClass("ul-drop-bottom"),e(".ul-drop-left").removeClass("ul-drop-left"),e(".ul-drop-right").removeClass("ul-drop-right"),e(".ul-drop-all").removeClass("ul-drop-all"),e(".ul-drop-all-block").removeClass("ul-drop-all-block"),e(".ul-drop-container-top").removeClass("ul-drop-container-top"),e(".ul-drop-container-bottom").removeClass("ul-drop-container-bottom"),e(".ul-headerFooter-controls-visible").removeClass("ul-headerFooter-controls-visible"),t.$el.off("scroll.onDragEl")},clearDropPos:function(){var t=this;t.$dropTarget.hasClass("ul-drop-"+t.position)&&t.$dropTarget.hasClass("ul-drop-all")&&t.$dropTarget.hasClass("ul-drop-all-block")||(t.ulDropSetDeny(!1),e(".ul-absolute-widgets").removeClass("ul-drop-absolute-hover"),e(".ul-container").removeClass("ul-block-dragOver"),e(".ul-drop-top").removeClass("ul-drop-top"),e(".ul-drop-bottom").removeClass("ul-drop-bottom"),e(".ul-drop-left").removeClass("ul-drop-left"),e(".ul-drop-right").removeClass("ul-drop-right"),e(".ul-drop-all").removeClass("ul-drop-all"),e(".ul-drop-all-block").removeClass("ul-drop-all-block"),e(".ul-drop-container-top").removeClass("ul-drop-container-top"),e(".ul-drop-container-bottom").removeClass("ul-drop-container-bottom"),e(".ul-drop-remove").removeClass("ul-hovered-drop-remove-el"),e(".ul-drop-placeholder").removeClass("ul-drop-all"),e(".ul-headerFooter-controls-visible").removeClass("ul-headerFooter-controls-visible"))},ulDropSetDeny:function(t){["ul-drop-top","ul-drop-bottom","ul-drop-left","ul-drop-right","ul-drop-all"].forEach(function(o){if(t){var r="".concat(o,"-deny");e(".".concat(o)).removeClass(o).addClass(r)}else{var n="".concat(o,"-deny");e(".".concat(n)).removeClass(n).addClass(o)}})},hoverDebouncer:{callback:null,trigger:function(e){var t=this,o=!!this.callback;this.callback=e,o||window.requestAnimationFrame(function(){t.triggerImmediateIfNeed()})},triggerImmediateIfNeed:function(){if(this.callback){var e=this.callback;this.callback=null,e()}}},hover:function(e,t,o,r){var n=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.hoverDebouncer.trigger(function(){n._hover(e,t,o,r,a)})},prevPos:null,$prevEl:null,$restoreEl:null,prevRow:!1,_hover:function(t,o,r,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=this,u=t-l.left,c=o-l.top,d=l.constructor.widgetGlobal.dropPosition[a]?!!l.constructor.widgetGlobal.dropPosition[a].fixed:!1;if(l.ulDropSetDeny(!1),d?l.$dropTarget=l.closestToCoordsAbs({left:u,top:c},l.$droppableCollection):l.$dropTarget=l.closestToCoords({left:u,top:c},l.$droppableCollection),null==l.$dropTarget)return!1;if(l.$prevEl&&!l.$prevEl.is("header")&&!l.$prevEl.is("footer")&&!l.$dropTarget.is("header")&&!l.$dropTarget.is("footer")&&l.$prevEl.attr("id")==l.$dropTarget.attr("id")&&l.position==l.prevPos&&l.prevRow==l.row)return void(l.$dropTarget=l.$restoreEl);if(l.$restoreEl=null,l.prevRow=!1,l.prevPos=l.position,l.$prevEl=l.$dropTarget,d)l.fixedDrop&&!l.$dropTarget.hasClass("ul-drop-remove")&&l.$dropTarget.hasClass("ul-absolute-widgets")&&(l.$dropTarget.hasClass("ul-position-absolute-bottom")?l.position="bottom":l.$dropTarget.hasClass("ul-position-absolute-center")?l.position="center":l.$dropTarget.hasClass("ul-position-absolute-top")?l.position="top":l.position="special",l.$dropTarget.children(".ul-widget").length&&l.$dropTarget.children(".ul-widget").attr("data-widget")!=a&&l.$dropTarget.attr("data-title",n("constructor.fixed replace")+" "+a),l.clearDropPos(),l.$dropTarget.addClass("ul-drop-absolute-hover")),l.$dropTarget.hasClass("ul-drop-remove")&&(l.position="bottom",l.clearDropPos(),l.$dropTarget.addClass("ul-hovered-drop-remove-el"));else{var p=!1;if("widget"!=r)l.$dropTarget.length||(l.$dropTarget=e("#"+l.$dropTarget.context.id)),(l.$dropTarget.is("header")||l.$dropTarget.is("footer"))&&(l.$dropTarget.parent().find(".ul-drop-placeholder").length&&!l.$dropTarget.parent().find(".ul-container").length&&(l.$dropTarget=l.$dropTarget.parent().find(".ul-drop-placeholder"),l.position="all ul-site-empty"),e('[class*="ul-drop-container"]').length&&(l.$dropTarget=e('[class*="ul-drop-container"]')),l.$dropTarget.is("header")?l.$dropTarget.parent().find(".ul-container").eq(0)&&(l.$dropTarget=l.$dropTarget.parent().find(".ul-container").eq(0),l.position="top"):l.$dropTarget.is("footer")&&(l.$dropTarget=l.$dropTarget.parent().find(".ul-container").eq(l.$dropTarget.parent().find(".ul-container").length-1),l.position="bottom")),l.$dropTarget.is("header")&&l.$dropTarget.is("footer")||("top"!=l.position&&"bottom"!=l.position||l.$dropTarget.is("header")||l.$dropTarget.is("footer")||("bottom"==l.position&&l.$dropTarget.next().length&&l.$dropTarget.next().hasClass("ul-drop-container-top")?p=!0:"top"==l.position&&l.$dropTarget.prev().length&&l.$dropTarget.prev().hasClass("ul-drop-container-bottom")&&(p=!0),l.$dropTarget.hasClass("ul-el-drag-mask")?(p=!0,l.clearDropPos(),l.$dropTarget.addClass("ul-drop-all-block")):"bottom"===l.position&&l.$dropTarget.next().length&&l.$dropTarget.next().hasClass("ul-el-drag-mask")?(p=!0,l.clearDropPos(),l.$dropTarget=l.$dropTarget.next(),l.$dropTarget.addClass("ul-drop-all-block")):l.$dropTarget.prev().length&&"top"===l.position&&l.$dropTarget.prev().hasClass("ul-el-drag-mask")&&(p=!0,l.clearDropPos(),l.$dropTarget=l.$dropTarget.prev(),l.$dropTarget.addClass("ul-drop-all-block")),p||(l.clearDropPos(),l.$dropTarget.addClass("ul-drop-container-"+l.position))),l.$dropTarget.hasClass("ul-drop-remove")?(l.clearDropPos(),l.$dropTarget.addClass("ul-hovered-drop-remove-el")):l.$dropTarget.hasClass("ul-drop-placeholder")&&(l.clearDropPos(),l.$dropTarget.addClass("ul-drop-all").addClass("ul-site-empty")));else{if(l.$dropTarget.is("header")||l.$dropTarget.is("footer")){var h=l.$dropTarget;if(l.clearDropPos(),h.find(".ul-headerFooter-controls").addClass("ul-headerFooter-controls-visible"),l.$dropTarget.is("header")){var g=l.$dropTarget.parent().find(".ul-container");g.length?(l.$dropTarget=g.eq(0),l.$dropTarget=l.$dropTarget.find(".ul-row").eq(0),l.position="top"):l.$dropTarget.parent().find(".ul-drop-placeholder").length&&(l.$dropTarget=l.$dropTarget.parent().find(".ul-drop-placeholder"),l.position="all ul-site-empty")}else if(l.$dropTarget.is("footer"))if(g=l.$dropTarget.parent().find(".ul-container"),g.length){var f=g.length-1,m=g.eq(g.length-1).find(".ul-row").length-1;l.$dropTarget=g.eq(f).find(".ul-row").eq(m),l.position="bottom"}else l.$dropTarget.parent().find(".ul-drop-placeholder").length&&(l.$dropTarget=l.$dropTarget.parent().find(".ul-drop-placeholder"),l.position="all ul-site-empty");l.$dropTarget.addClass("ul-drop-"+l.position)}else l.$dropTarget.hasClass("ul-col")&&!l.$dropTarget.children(".ul-widget").length||l.$dropTarget.hasClass("ul-widget")&&l.$dropTarget.hasClass("ul-el-drag-mask")||l.$dropTarget.hasClass("ul-drop-placeholder")?(l.clearDropPos(),l.$dropTarget.addClass("ul-drop-all"),l.$dropTarget.hasClass("ul-drop-placeholder")&&l.$dropTarget.addClass("ul-site-empty")):l.$dropTarget.hasClass("ul-drop-remove")?(l.clearDropPos(),l.$dropTarget.addClass("ul-hovered-drop-remove-el")):(l.$dropTarget.hasClass("ul-widget")?("left"!=l.position&&"right"!=l.position||(l.$dropTarget=l.$dropTarget.closest(".ul-col"),"right"==l.position&&l.$dropTarget.next().length&&l.$dropTarget.next().hasClass("ul-drop-left")?p=!0:"left"==l.position&&l.$dropTarget.prev().length&&l.$dropTarget.prev().hasClass("ul-drop-right")?p=!0:"left"===l.position&&l.$dropTarget.prev().length&&l.$dropTarget.prev().children(".ul-el-drag-mask").length&&1===l.$dropTarget.prev().closest(".ul-col").children(".ul-widget").length?(p=!0,l.clearDropPos(),l.$dropTarget=l.$dropTarget.prev().children(".ul-el-drag-mask"),l.$dropTarget.addClass("ul-drop-all")):"right"===l.position&&l.$dropTarget.next().length&&l.$dropTarget.next().children(".ul-el-drag-mask").length&&1===l.$dropTarget.next().closest(".ul-col").children(".ul-widget").length&&(p=!0,l.clearDropPos(),l.$dropTarget=l.$dropTarget.next().children(".ul-el-drag-mask"),l.$dropTarget.addClass("ul-drop-all"))),"bottom"!=l.position&&"top"!=l.position||l.$dropTarget.closest(".ul-row").children(".ul-col").length<2&&l.$dropTarget.closest(".ul-row").children(".ul-col").children(".ul-widget").length<2&&(p=!1,l.$dropTarget=l.$dropTarget.closest(".ul-row")),"top"==l.position&&l.$dropTarget.prev().length&&l.$dropTarget.prev().hasClass("ul-drop-bottom")?(p=!0,l.$dropTarget=l.$dropTarget.prev()):"bottom"==l.position&&l.$dropTarget.next().length&&l.$dropTarget.next().hasClass("ul-drop-top")&&(p=!0,l.$dropTarget=l.$dropTarget.next())):l.$dropTarget.hasClass("ul-row")?"top"==l.position&&l.$dropTarget.prev().length&&l.$dropTarget.prev().hasClass("ul-drop-bottom")?(p=!0,l.$dropTarget=l.$dropTarget.prev()):"bottom"==l.position&&l.$dropTarget.next().length&&l.$dropTarget.next().hasClass("ul-drop-top")&&(p=!0,l.$dropTarget=l.$dropTarget.next()):l.$dropTarget.hasClass("ul-col")&&("bottom"==l.position?l.$dropTarget=l.$dropTarget.parent():"left"===l.position&&l.$dropTarget.closest(".ul-col").children(".ul-el-drag-mask").length&&1===l.$dropTarget.closest(".ul-col").children(".ul-widget").length?(p=!0,l.clearDropPos(),l.$dropTarget=l.$dropTarget.children(".ul-el-drag-mask"),l.$dropTarget.addClass("ul-drop-all")):"right"===l.position&&l.$dropTarget.closest(".ul-col").children(".ul-el-drag-mask").length&&1===l.$dropTarget.closest(".ul-col").children(".ul-widget").length&&(p=!0,l.clearDropPos(),l.$dropTarget=l.$dropTarget.children(".ul-el-drag-mask"),l.$dropTarget.addClass("ul-drop-all"))),p||(l.clearDropPos(),l.$dropTarget.addClass("ul-drop-"+l.position)));l.$dropTarget.is("header")||l.$dropTarget.is("footer")||l.$dropTarget.closest(".ul-container").addClass("ul-block-dragOver")}}if(l.deny=!1,"widget"==r){var v=l.constructor.widgetGlobal.minColsTable[a]||2;if(l.$dropTarget.hasClass("ul-widget")){var b=l.$dropTarget.parent(".ul-col"),w=0;b.closest(".ul-row").children(".ul-col").each(function(t,o){var r=e(o),n=l.constructor._getMinCols(r);w+=r.get(0)==b.get(0)?i.max([n,v]):n}),w>12&&(l.deny=!0)}l.$dropTarget.hasClass("ul-col")&&(b=l.$dropTarget,w=0,b.closest(".ul-row").children(".ul-col").each(function(t,o){var r=e(o);w+=l.constructor._getMinCols(r)}),w+v>12&&(l.deny=!0));var T=l.$dropTarget.closest(".ul-container").hasClass("ul-symbol"),C=s&&e("#".concat(s)).closest(".ul-container").hasClass("ul-symbol");s&&(C&&!T||!C&&T)&&(l.deny=!0)}l.ulDropSetDeny(l.deny)},getAndAppendDropPositionAbsWidget:function(){return e('<div id="special-0" class="ul-absolute-widgets ul-position-absolute-bottom ul-position-absolute-bottom--liveChat ul-col" data-position="left"></div><div id="special-1" class="ul-absolute-widgets ul-position-absolute-bottom ul-position-absolute-bottom--liveChat ul-col" data-position="right"></div><div id="special-2" class="ul-absolute-widgets ul-position-absolute-center ul-col" data-position="left"></div><div id="special-3" class="ul-absolute-widgets ul-position-absolute-center ul-col" data-position="right"></div><div id="special-4" class="ul-absolute-widgets ul-position-absolute-center ul-col" data-position="center"></div><div id="special-5" class="ul-absolute-widgets ul-position-absolute-special ul-col" data-position="left"></div><div id="special-6" class="ul-absolute-widgets ul-position-absolute-special ul-col" data-position="right"></div><div id="special-7" class="ul-absolute-widgets ul-position-absolute-top ul-col" data-position="right"></div>').appendTo(e("#ul-main #body-fict"))},loadAbsWidgetConstructorModeAndReposition:function(t,o){var r=this;e.each(e("<div>"+t.absWidgets+"</div>").children(),function(t,n){"undefined"===e(n).attr("data-party")&&(e(n).data("data").positionWrap.right?(e(n).attr("data-party","right"),e(n).data().data.party="right"):(e(n).attr("data-party","left"),e(n).data().data.party="left"));var a=o.parent().find(".ul-position-absolute-"+e(n).data("position")+"[data-position="+e(n).data("party")+"]");r.constructor.widgetGlobal.proto.widgetAbsWrapSize(e(n)),a.append(n)}),r.constructor.repositionAbsWidget(),e.each(o,function(t,o){e(o).children(".ul-widget").length&&r.constructor.repositionAbsWidget(e(o))})},isLocalStorageSupported:function(){var e="testSupportLocalStorage",t=window.localStorage;try{return t.setItem(e,e),t.removeItem(e),!0}catch(o){return console.log("Saving to storage problem. Change browser.",o),!1}}(),setPage:function(){var e=arguments;return _asyncToGenerator(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.dispatch(window.actions.unloadPage(e));case 2:case"end":return t.stop()}},t)}))()},_realSetPage:function(o,i,l){var u=this;e(document).trigger("beforeChangePage",{url:t.params.page}),e.ajax({url:o,api:!0,doNotShowAjaxError:!0,ok:function(r){t.params.pageIsEditable=r.params.pageIsEditable,t.params.panelDefault=r.params.panelDefault;var n=r.params.styles.map(function(e){return e.match(/^http/)?(t.requireCss(e),null):e.match(/\.css(\?x=.*)?$/)?"css!"+e:"less!"+e}).filter(function(e){return null!=e});require(n,function(){require(["constructor"],function(n){s.add({fromFile:"js/constructor/page.js",title:"setPage start",desc:"url: "+o}),e("#body-fict").html(r.body).removeClass(function(e,t){return(t.match(/(^|\s)ul-page-\S+/g)||[]).join(" ");
}).addClass("ul-page-"+r.params.pageType+"-"+r.params.pageId.replace(/^__/,"")),e.extend(t.params,r.params),window.dispatch(window.actions.loadPage(r.params.pageId)),e(document).trigger("changePage",{url:t.params.page,template:t.params.template}),a.pageChanged(l),u.constructor=n;var c=u.getAndAppendDropPositionAbsWidget();u.loadAbsWidgetConstructorModeAndReposition(r,c),u.constructor.init(),u.constructor.setSiteSettings(null,r.pageParams.theme);var d=t.menu.$main.find(".icon-content-pages-blog");switch(r.params.pageType){case"common":case"special":d.hide();break;case"blog":d.show()}u.isLocalStorageSupported&&"common"===r.params.pageType&&r.params.pageIsEditable&&(localStorage.previousPageId=r.params.pageId),t.menu.$content.find('[data-single-widget="true"]').removeAttr("disabled"),r.singleWidgets&&(u.constructor.singleWidgets=r.singleWidgets,r.singleWidgets.forEach(function(t){e(window).trigger("singleWidget",{active:!1,wtype:t})})),i&&i({singleWidgets:r.singleWidgets}),s.add({fromFile:"js/constructor/page.js",title:"setPage stop",desc:"url: "+o})})})},error:function(e){404===e.status&&r.confirm({title:n("constructor.page not found"),text:n("constructor.page not found and is probaly removed")})}})},selectDroppable:function(t,o){var r=this,n=this.$el;r.$droppableCollection||("block"==t||"favorite-block"==t?r.$droppableCollection=n.find(".ul-container:not(.ul-dragin-helper), .ul-el-drag-mask, .ul-drop-placeholder, header, footer"):"widget"==t?r.$droppableCollection=n.find(["#ul-content .ul-col > .ul-widget:not(.js-draging)","#ul-content .ul-col","#ul-content .ul-row > .ul-col",".ul-el-drag-mask",".ul-drop-placeholder","header","footer"].join(", ")):"absWidget"==t&&(e.each(Object.keys(r.constructor.widgetGlobal.dropPosition[o].position),function(t,a){e.each(r.constructor.widgetGlobal.dropPosition[o].position[a],function(e,t){n.find("#body-fict > .ul-position-absolute-"+a+'[data-position="'+t+'"]:not(.js-draging)').addClass("ul-show-drop-pos").css({width:"",height:""})})}),r.$droppableCollection=n.find(".ul-show-drop-pos")),e("body").hasClass("ul-left-panel-hide")||r.$droppableCollection.push(e("body").find(".ul-drop-remove")[0]),r.$droppableCollection=r.$droppableCollection.map(function(){return{$el:e(this)}}),r.dropCollectionToOffsetObjects()),r.$el.on("scroll.onDragEl",r.dropCollectionToOffsetObjects)},startDrop:function(t,o){var r=this;r.dragEl=!0,r.fixedDrop=!1,r.constructor.widgetGlobal.dropPosition[o]&&r.constructor.widgetGlobal.dropPosition[o].fixed&&(r.fixedDrop=!0,e("#body-fict").children(".ul-abs-overlay-drag").length||e("#body-fict").append('<div class="ul-abs-overlay-drag"></div>')),r.selectDroppable(t,o)},isHover:function(t){this.dragEl=!1,this.constructor.getDragStatus(),e(".ul-elements-controls-visible").removeClass("ul-elements-controls-visible"),e(window).off("fakeEvent"),e(window).on("mousemove.fakeEvent",function(e){t=e}),setTimeout(function(){if(t){var o=jQuery.Event("mouseenter");o.pageX=t.pageX,o.pageY=t.pageY;var r=e(document.elementFromPoint(o.pageX,o.pageY));r=r.closest(".ul-widget, .ul-container, footer, header"),r.trigger(o,"fakeEvent"),e(window).off("fakeEvent")}},400)},stopDrop:function(){var t=this;if(t.dragEl=!1,e(".ul-abs-overlay-drag",e("#body-fict")).remove(),e(".ul-absolute-widgets").removeClass("ul-show-drop-pos"),t.fixedDrop&&t.$dropTarget){t.$dropTarget.removeAttr("data-title");var o=e(".ul-absolute-widgets:not(:empty)","#body-fict");e.each(o,function(t,o){e(o).css({width:e(o).children(".ul-widget").length?e(o).children(".ul-widget").outerWidth(!0):"",height:e(o).children(".ul-widget").length?e(o).children(".ul-widget").outerHeight(!0):""})}),t.constructor.repositionAbsWidget()}t.fixedDrop=null,t.deselectDroppable(),t.$droppableCollection=null,t.prevPos=null,t.$prevEl=null,t.$restoreEl=null,t.prevRow=!1},autoScrollIframeDrag:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:110,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,n=this,a=n.$el,i=n.$el.height(),s=1,l=5,u=!1;return t.pageY<0||e(window).height()<=t.pageY?(clearInterval(n.intTopHandler),clearInterval(n.intBottomHandler),u=!1,n.stopAutoscroll(),!1):(t.pageY<=o?(u=!0,n.stopAutoscroll(),n.intTopHandler=setInterval(function(){a.scrollTop(a.scrollTop()-l),a.scrollTop()==r&&clearInterval(n.intTopHandler)},s)):i-o<=t.pageY?(u=!0,n.stopAutoscroll(),n.intBottomHandler=setInterval(function(){a.scrollTop(a.scrollTop()+l),a.scrollTop()==r&&clearInterval(n.intBottomHandler)},s)):i-o>=t.pageY&&(u=!1),void(u||(clearInterval(n.intTopHandler),clearInterval(n.intBottomHandler))))},autoScrollIframeDragReact:function(t){var o=this,r=o.$el,n=o.$el.height(),a=50,i=110,s=1,l=5,u=!1;return 0>t||e(window).height()<=t?(clearInterval(o.intTopHandler),clearInterval(o.intBottomHandler),u=!1,o.stopAutoscroll(),!1):(i>=t?(u=!0,o.stopAutoscroll(),o.intTopHandler=setInterval(function(){r.scrollTop(r.scrollTop()-l),r.scrollTop()==a&&clearInterval(o.intTopHandler)},s)):t>=n-i?(u=!0,o.stopAutoscroll(),o.intBottomHandler=setInterval(function(){r.scrollTop(r.scrollTop()+l),r.scrollTop()==a&&clearInterval(o.intBottomHandler)},s)):n-i>=t&&(u=!1),void(u||(clearInterval(o.intTopHandler),clearInterval(o.intBottomHandler))))},stopAutoscroll:function(){var e=this;clearInterval(e.intTopHandler),clearInterval(e.intBottomHandler)}};return c}),define("sitePublish",["jquery","nf","i18n"],function(e,t,o){var r={publish:function(t,o,n,a){var i=r;i._checkStatus(t,function(r,s){return r?(a(),void i._showError()):s?n():void e.ajax({url:"/sites/url/"+t+"/setPublished",method:"post",data:{published:!0}}).done(function(e){return e[0]?(a(),i._showError()):void o()}).fail(function(){a(),i._showError()})})},showPublishedWindow:function(e){var t;try{t=JSON.parse(localStorage.publishCongrats)}catch(o){}t&&t[e]||require(["publishedWindow"],function(t){t.init(e)})},showPublishErrorWindow:function(){require(["PublishErrorWindow"],function(e){var t=new e;t.show()})},_checkStatus:function(r,n){e.ajax({url:"/sites/url/"+r+"/getStatus",method:"get"}).done(function(e){return e[0]?n(e[0]):void(0===e[1].status?t.confirm({title:o("all.under construction mode enabled"),text:o("all.are you sure you want to publish your site?"),ok:o("constructor.publish"),cancel:"",okCb:function(){n()},cancelCb:function(){n(null,!0)}}):1===e[1].status&&n())}).fail(function(){n("error while checking site status")})},_showError:function(){t.notify(o("constructor.error during site publish"))}};return r}),define("blog",["jquery","U","ul-framework","logActions"],function(e,t,o,r){var n={init:function(t){this.menu=t,e(document).on("beforeChangePage.blogSignal",n.beforeChangePage.bind(n)).on("changePage.blogSignal",n.changePage.bind(n)).on("showBlogPanel.blogSignal",n.showPanel.bind(n)).on("closeBlogPanel.blogSignal",n.closePanel.bind(n)),r.add({fromFile:"js/blog/blog.js",title:"init blog"})},_panelLastState:"closePanel",showPanel:function(){o.folds.init(),o.range.init(),o.folds.after(),n._panelLastState="showPanel"},closePanel:function(){n._panelLastState="closePanel"},lastState:"_deinit",beforeChangePage:function(){var e=t.params.pageType;"blog"===e&&"_init"===n.lastState&&(n._deinit(),n.lastState="_deinit")},changePage:function(){var o=t.params.pageType;"blog"===o&&require(["blog-body"],function(t){e.extend(n,t),n._init(),n.lastState="_init"})},reinitPanel:function(){"closePanel"===this._panelLastState&&(this.menu.currentPanel.detach(),this.menu.setPanel("panelBlog"))}};return n});var h={clamp:function(e){return Math.min(1,Math.max(0,e))},rgb2hex:function(e){var t=e[0],o=e[1],r=e[2];return t=t.toString(16),o=o.toString(16),r=r.toString(16),1==t.length&&(t="0"+t),1==o.length&&(o="0"+o),1==r.length&&(r="0"+r),("#"+t+o+r).toUpperCase()},hex2rgb:function(e){4==e.length&&(e=e.replace(/(\w)/g,"$1$1"));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null},hsl2rgb:function(e){function t(e){return e=0>e?e+1:e>1?e-1:e,1>6*e?s+(i-s)*e*6:1>2*e?i:2>3*e?s+(i-s)*(2/3-e)*6:s}var o=e.h,r=e.s,n=e.l,a=e.a;o=o%360/360,r=this.clamp(r),n=this.clamp(n),a=this.clamp(a);var i=.5>=n?n*(r+1):n+r-n*r,s=2*n-i;return{rgb:[Math.round(255*t(o+1/3)),Math.round(255*t(o)),Math.round(255*t(o-1/3))],a:a}},rgb2hsl:function(e,t){"undefined"==typeof t&&(t=0);var o,r,n=e[0]/255,a=e[1]/255,i=e[2]/255,s=t,l=Math.max(n,a,i),u=Math.min(n,a,i),c=(l+u)/2,d=l-u;if(l===u)o=r=0;else{switch(r=c>.5?d/(2-l-u):d/(l+u),l){case n:o=(a-i)/d+(i>a?6:0);break;case a:o=(i-n)/d+2;break;case i:o=(n-a)/d+4}o/=6}return{h:360*o,s:r,l:c,a:s}},rgba2str:function(e,t){return"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+(t||1)+")"},str2rgb:function(e){var t;if(e.match(/^rgba/))t=e.match(/^rgba\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);else{if(!e.match(/^rgb\(/))throw new Error("wrong rgb format "+e);t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\s*\)$/)}return{rgb:[t[1],t[2],t[3]],a:t[4]}},darken:function(e,t){return e.l-=t/100,e.l=this.clamp(e.l),e},lighten:function(e,t){return e.l+=t/100,e.l=this.clamp(e.l),e},fadein:function(e,t){return e.a+=t/100,e.a=this.clamp(e.a),e},fadeout:function(e,t){return e.a-=t/100,e.a=this.clamp(e.a),e},fade:function(e,t){return e.a=t/100,e.a=this.clamp(e.a),e}},___={h:h,fill:function(e,t,o){var r="",n={},a=null;t.forEach(function(e,t){e.blocks.forEach(function(o,r){n["site_"+t+"_block_"+r]=o.value,o.textColors.forEach(function(o,i){n["site_"+t+"_blocks_"+r+"_"+i]=e.blocks[r].textColors[i],a=t})})}),e.split("\n").forEach(function(e){var t=e.match(/\[.*?site_\d_block.*?\]/g);if(t){var o=t[0].match(/site_(\d){1}_block/)[1];if(o=o?parseInt(o):null,null===o)throw new Error("Stencil parse error "+t[0]);if(o>a)return;var i=0;t.forEach(function(o,r){i=e.indexOf("[",i);var a=e.substr(i+1,e.indexOf("]",i)-i-1),s=a.split("|"),l=s.pop().trim();if(!n[l])throw console.error(l),new Error("Color not defined in colorScheme: "+l);var u=n[l];if(s.length>0)if(u.match(/^#/))u=h.rgb2hsl(h.hex2rgb(u));else{if(!u.match(/rgb\(/))throw new Error("Unknown color format: "+u);var c=h.str2rgb(u);u=h.rgb2hsl(c.rgb,c.a)}for(;s.length>0;){var d=s.pop(),p=d.split(" ");switch(p[0]){case"darken":u=h.darken(u,parseInt(p[1]));break;case"lighten":u=h.lighten(u,parseInt(p[1]));break;case"fade":u=h.fade(u,parseInt(p[1]));break;case"fadein":u=h.fadein(u,parseInt(p[1]));break;case"fadeout":u=h.fadeout(u,parseInt(p[1]))}}if("string"!=typeof u){var g=h.hsl2rgb(u);u=u.a<1?h.rgba2str(g.rgb,g.a):h.rgb2hex(g.rgb)}e=e.replace(t[r],u)}),r+=e+"\n"}else r+=e+"\n"}),o(null,r)}};"undefined"!=typeof define?define("js/share/cssStencil",[],function(){return ___}):module.exports=___,define("pipette",["jquery","U","js/share/cssStencil"],function(e,t,o){var r={colorScheme:null,stencil:null,currentSiteTheme:null,activateColorSchemeEditMode:function(t){var o=this;o.bodyClass=e("#body").attr("class"),o.setColorSchemeCss(t,function(){e("[href*='customColorScheme-constructor']").prop("disabled",!0),e("#body").attr("class","g-theme-site-1")})},addConstructorCssLink:function(o){var r=e("[href*='customColorScheme-constructor'], [href*='main-constructor.css']"),n="".concat(t.params.customCssUrl,"/customColorScheme-constructor.css");t.params.isTemplateServer&&(n="/templates/".concat(t.params.template,"/css/main-constructor.css"));var a=e("<link>",{rel:"stylesheet",href:"".concat(n,"?v=").concat(t.guid())});a.load(function(){"function"==typeof o&&o(),r.remove()}),e("head").append(a)},addMainCssLink:function(o){var r=e("[href*='customColorScheme-constructor'], [href*='main-constructor.css']"),n=e("<link>",{rel:"stylesheet",href:"/templates/"+t.params.template+"/css/main-constructor.css?v="+Math.random().toString(36).substring(10)});n.load(function(){"function"==typeof o&&o(),r.remove()}),e("head").append(n)},destroyColorSchemeEditMode:function(){var t=this;e("#body").attr("class",t.bodyClass),e("#colorScheme").remove(),e("[href*='customColorScheme-constructor']").prop("disabled",!1)},fillStencil:function(e,t,r){var n=this;e=[e[t]],o.fill(n.stencil,e,r)},getCurrentSiteTheme:function(o){var r=this;e.ajax({url:"/sites/url/"+t.params.site+"/pages/id/index/theme",method:"GET",dataType:"json",api:!0,ok:function(e){var t=e.theme,n=/g-theme-site-(\d)/.exec(t);r.currentSiteTheme=n[1],o()}})},loadColorScheme:function(o){var r=this;e.ajax({url:"/sites/url/"+t.params.site+"/customColorSchemes/getList",method:"GET",dataType:"json",api:!0,ok:function(e){r.colorScheme=e.data,o()}})},loadStencil:function(o){var r=this;e.ajax({url:"/templates/"+t.params.template+"/css/siteStencil-constructor.css",method:"GET",dataType:"text",success:function(e){r.stencil=e,"function"==typeof o&&o()}})},save:function(o,r){var n=this;e.ajax({url:"/sites/url/"+t.params.site+"/customColorSchemes/save",method:"POST",dataType:"json",api:!0,contentType:"application/json; charset=utf-8",data:JSON.stringify({data:n.colorScheme,opts:o}),ok:function(){"function"==typeof r&&r()}})},setBlockColor:function(e,t){var o=this;return o.colorScheme[o.currentSiteTheme-1].blocks[e].value=t,o.colorScheme},setColorSchemeCss:function(t,o){e("#colorScheme").addClass("colorSchemeToRemove");var r=e("<style>",{id:"colorScheme",type:"text/css",text:t});r.load(function(){"function"==typeof o&&o(),e(".colorSchemeToRemove").remove()}),e("head").append(r)},setTextColor:function(e,t,o){var r=this;return r.colorScheme[r.currentSiteTheme-1].blocks[e].textColors[t]=o,r.colorScheme}};return r}),define("constructorLogger",["jquery","U","_"],function(e,t,o){var r="/sites/url/"+t.params.site,n={log:function(e){var t=this;e=o.extend({onSuccess:function(){},onError:function(){}},e);var r=t._actionsRoutes[e.action];return r?void t._send({route:r,data:e.data||{}}):void console.error("invalid log action")},_actionsRoutes:{widgetSearch:r+"/constructorStats/widgetSearch"},_send:function(t){e.ajax({url:t.route,method:"post",data:t.data}).done(t.onSuccess).fail(t.onError)}};return{log:n.log.bind(n),adminLog:function(o,r,n){e.ajax({type:"post",url:"/sites/url/".concat(t.params.site,"/pages/id/").concat(t.params.pageId,"/device_logging"),data:{mark:o,data:r},api:!0,ok:function(){return n()},noOk:function(e){return n(e)}})}}}),define("panel",["jquery","lodash","U","history","i18n","ul-framework","nf","model/pages","page","sitePublish","blog","locale","moment","pipette","logActions","ulLoader","constructorLogger"],function(e,t,o,r,n,a,i,s,l,u,c,d,p,h,g,f,m){var v={panels:{current:null},visibleClass:"ul-menu-desc--visible",$el:e("#ul-left-menu"),$main:e(".ul-main-menu","#ul-left-menu"),$content:e(".ul-menu-content","#ul-left-menu"),$undo:e('[data-action="undo"]',".ul-main-menu"),$redo:e('[data-action="redo"]',".ul-main-menu"),tooltipThreshold:[[20,20],[10],[40]],_isPublishing:!1,_prevPcr:1,_currentPcr:1,_longPublication:!1,init:function(){function e(){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=this,e._historyBtnsLight(),e._addEvents(),e.$content.removeClass("ul-loading-indicator"),e._loadAll(),p.locale(d.get()),e._publish.checkPublishDate(),c.init(this),g.add({fromFile:"js/constructor/menu.js",title:"menu init"}),t=window.constructorPreviewMode?"panelPreview":o.params.panelDefault,r.next=12,e.setPanel(t||"panelPreview");case 12:case"end":return r.stop()}},r,this)}));return e}(),counterCheck:function(t,r,a){var i=this;r||(r=function(){}),a||(a=function(){}),e.ajax({url:"/sites/url/"+o.params.site+"/getPubCounters",method:"get",api:!0,ok:function(s){!e("#ul-panelDialog").hasClass(i.visibleClass)&&s.numPublished<i.tooltipThreshold.length&&s.numTooltiped<i.tooltipThreshold[s.numPublished].length&&s.numModified>=i.tooltipThreshold[s.numPublished][s.numTooltiped]&&i._publish.showTooltip(s.numPublished),a(s),o.params.isLandingInTest?i._publish.setInTest():s.numModified>0?i._publish.setPubish():s.numPublished>0&&i._publish.setPubished(),s.isPublishing?(i._publish.publishLoader(),i._pubTimer&&clearTimeout(i._pubTimer),i._pubTimer=setTimeout(function(){i._prevPcr=i._currentPcr,i._currentPcr<=1.15?i._currentPcr+=.01:i._currentPcr<=10?i._currentPcr*=1.25:i._currentPcr=10,i.counterCheck(!1,r)},1e3*i._currentPcr)):(i._pubTimer||t)&&(clearTimeout(i._pubTimer),delete i._pubTimer,clearTimeout(i._publish._publishTimer),delete i._publish._publishTimer,i._currentPcr=1,i._prevPcr=1,i._isPublishing=!1,s.numPublishTrials?f.hide(function(){i.showPublishError(),r([n("constructor.error during site publish"),null])}):(i._longPublication?(i._longPublication=!1,f.hide(function(){i.showPublished()})):i.showPublished(),f.updatePreview(),r()))},noOk:function(){console.warn("Failed getPubCounters request")}}).fail(function(){i._longPublication?(i._longPublication=!1,f.hide(function(){i._publish.setPubish()})):i._publish.setPubish(),console.warn("Failed getPubCounters request")})},_hidePanel:!1,_addEvents:function(){var t=this;t.counterCheck();var n=function(t){t.customColorScheme?h.addConstructorCssLink(function(){e("#body").trigger("setSiteSettings.constructor",{id:null,settings:t})}):h.addMainCssLink(function(){e("#body").trigger("setSiteSettings.constructor",{id:null,settings:t})})},a=null;e(document).on("historyBtnsLight",function(){t._historyBtnsLight()}).on("keydown",function(t){e(this).data("disableCtrlZ")||(r.states.length||r.forwardStates.length)&&(1!=t.ctrlKey&&1!=t.metaKey||(25!=t.charCode&&89!=t.keyCode||t.preventDefault(),26!=t.charCode&&90!=t.keyCode||t.preventDefault(),26!=t.charCode&&90!=t.keyCode||!r.states.length||r.undo(),25!=t.charCode&&89!=t.keyCode||!r.forwardStates.length||r.redo()))}).on("click",".js-panel-action",function(){var n=e(this),a=e(this).attr("data-action"),i={undo:function(){g.add({fromFile:"js/constructor/menu.js",title:"action: "+a,desc:"url: /sites/url/"+o.params.site+"/pages/id/"+o.params.pageId}),r.undo(),window.analyticsHandler("yandexMetrika.mainId","reachGoal","system-history-undo")},redo:function(){g.add({fromFile:"js/constructor/menu.js",title:"action: "+a,desc:"url: /sites/url/"+o.params.site+"/pages/id/"+o.params.pageId}),r.redo(),window.analyticsHandler("yandexMetrika.mainId","reachGoal","system-history-redo")},publish:function(){g.add({fromFile:"js/constructor/menu.js",title:"action: "+a,desc:"url: /sites/url/"+o.params.site+"/pages/id/"+o.params.pageId}),v._publish.publish()},panel:function(){g.add({fromFile:"js/constructor/menu.js",title:"action: "+a+" page: "+n.attr("data-panel"),desc:"url: /sites/url/"+o.params.site+"/pages/id/"+o.params.pageId}),"panelPreview"!==n.attr("data-panel")&&(t._hidePanel||n.attr("data-panel")!==t.panels.current?t._hidePanel&&t.showPanel():t.hidePanel()),null!=t.panels.current&&t.setPanel(n.attr("data-panel")),"panelPreview"===n.attr("data-panel")?o.hist.pushState({data:{url:"/sites/url/"+o.params.site+"/pages/id/"+o.params.pageId+"/preview",panel:"panelPreview"},title:"preview",url:"/sites/url/"+o.params.site+"/pages/id/"+o.params.pageId+"/preview"}):"panelDevice"===n.attr("data-panel")&&m.adminLog("mx panelDevice",{},function(e){e&&console.error("menu logger.adminLog error",e)}),o.constructor.updateAbsGrid()},shopSettings:function(){require(["shop/settings"],function(e){e.open()})},hideShowPannel:function(){t._hidePanel?t.showPanel():t.hidePanel(),o.constructor.updateAbsGrid()}};null==i[a]?console.warn("undefined action",a):i[a]()}).on("sendPush-changeCustomScheme",function(e,t){t&&"undefined"!=typeof t.customColorScheme&&n(t)}).on("siteChanged",function(e,r){g.add({fromFile:"js/constructor/menu.js",title:"siteChanged",desc:"url: /sites/url/"+o.params.site+"/pages/id/"+o.params.pageId}),a&&clearInterval(a),a=setTimeout(function(){a=null,t.counterCheck()},1e3),r&&"undefined"!=typeof r.customColorScheme&&n(r)}).on("showDropArea",t.dropRemoveEl.show).on("hideDropArea",t.dropRemoveEl.hide).on("click",".js-left-menu.ul-side-menu",function(o){e(o.target).hasClass("js-panel-action")||t._hidePanel&&t.showPanel()}),e(window).on("absWidget singleWidget",function(t,r){var n=e("[data-widget="+r.wtype+"]",".js-panel-constructor-elements");r.active?n.removeAttr("disabled"):n.attr("disabled","disabled"),g.add({fromFile:"js/constructor/menu.js",title:"absWidget singleWidget del/add",desc:"url: /sites/url/"+o.params.site+"/pages/id/"+o.params.pageId})}).on("shopCreated",function(){e('.js-panel-action[data-action="shopSettings"]',t.$el).fadeIn(),e(".ul-eyecatcher-ribbon").addClass("ul-eyecatcher-ribbon-shop"),require(["shop/tooltips/settings"],function(e){e.show()})})},setPanel:function(e){var t=this;return _asyncToGenerator(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null===t.panels.current){r.next=10;break}if(e!==t.panels.current){r.next=3;break}return r.abrupt("return");case 3:if(n=t.panels.current,g.add({fromFile:"js/constructor/menu.js",title:"set panel",desc:"url: /sites/url/".concat(o.params.site,"/pages/id/").concat(o.params.pageId," panelName: ").concat(e)}),o.constructor.deviceMode||(o.constructor.deviceMode={}),"panelConstructor"!==e||o.constructor.deviceMode.isPanelConstructorEditable){r.next=9;break}return t.setPanelDevice("panelConstructor"),r.abrupt("return");case 9:"panelConstructor"!==e||o.params.pageIsEditable||t.confirmPanelDevice(n);case 10:return r.next=12,t._loadPanel(e);case 12:case"end":return r.stop()}},r)}))()},setPanelDevice:function(e){var t=this;return _asyncToGenerator(regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r.clearState(),g.add({fromFile:"js/constructor/menu.js",title:"set panel device"}),i=t.$content.find('[data-target="'.concat(e,'"]')),"panelConstructor"===e){a.next=7;break}return a.next=6,t._loadPanel(e);case 6:return a.abrupt("return");case 7:t.lockPanel(i,{information:{title:n("constructor.lockPanel.title"),iconImage:"/img/constructor/device/modes_constructor.svg"},isCloseLock:!0,button:{visible:!0,classDesign:"ul-button-blue",text:n("constructor.lockPanel.button"),event:{cb:function(){t.panels[e]&&t.panels[e].initEvent(),"panelConstructor"!==o.params.panelCurrent||o.params.pageIsEditable||t.confirmPanelDevice("panelDevice"),o.constructor.setDevice("desktop",e)},namespace:"lockConstructorModeInDevice"}},beforeOpen:function(){function o(){return r.apply(this,arguments)}var r=_asyncToGenerator(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t._loadPanel(e);case 2:case"end":return o.stop()}},n)}));return o}()});case 8:case"end":return a.stop()}},a)}))()},confirmPanelDevice:function(e){var r=this;return _asyncToGenerator(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:s.load(o.params.site,function(a){var s=t.findWhere(a,{id:localStorage.previousPageId})||t.findWhere(a,{id:"index"});i.confirm({title:"".concat(n("all.return to previous page"),' "').concat(s.title,'"'),ok:n("all.return"),cancel:"",okCb:function(){l.setPage("/sites/url/".concat(o.params.site,"/pages/id/").concat(s.id,"/edit"),function(){r.setPanel("panelConstructor")}),o.hist.pushState({data:{url:"/sites/url/".concat(o.params.site,"/pages/id/").concat(s.id,"/edit")},title:"title",url:"/sites/url/".concat(o.params.site,"/pages/id/").concat(s.id,"/constructor")})},cancelCb:function(){r._loadPanel(e)}})});case 1:case"end":return a.stop()}},a)}))()},lockPanel:function(o,r){var n=this;return e(".js-lockPanel",o).length?void r.beforeOpen():void require(["text!html/panelLock.html"],function(a){var i=e(t.template(a,{iconClass:r.information.iconClass,iconImage:r.information.iconImage,title:r.information.title,description:r.information.description,button:r.button})),s=i.appendTo(o);if(r.button.event.cb){var l=r.button.event.cb;r.isCloseLock&&(l=function(){s.fadeOut("fast",function(){s.remove()}),r.button.event.cb()}),s.on("click.".concat(r.button.event.namespace||"overlayLockPanel"),".js-confirm-lockPanel",l.bind(n))}r.beforeOpen(s)})},currentPanel:{detach:function(){v.panels[v.panels.current].deinit(v)},attach:function(){v.panels[v.panels.current].init(v),v._switchActive(v.panels.current)},getPanel:function(){return v.panels[v.panels.current]}},showPublished:function(){var e=this;e._publish.$el.removeClass("loading").removeClass("disabled"),e._publish.setPublishDate(new Date),e._publish.setPubished(),u.showPublishedWindow(o.params.site)},showPublishError:function(){var e=this;e._publish.$el.removeClass("disabled"),e._publish.setPubish(),u.showPublishErrorWindow(o.params.site),window.analyticsHandler("yandexMetrika.mainId","reachGoal","client--loader-error")},_publish:{$el:e(".js-site-publish",".ul-main-menu"),date:null,setInTest:function(){this.$el.addClass("ul-site-publish--in-test").attr("title",n("constructor.landing in test")).attr("disabled","disabled")},setPubish:function(){var e="";this.date?(e=this.getDateFormat(),this.$el.attr("title",n("constructor.last published on DATE",e))):this.$el.attr("title",n("constructor.publish")),this.$el.removeClass("icon-content-special-check ul-site-publish--published").addClass("icon-content-special-publish"),this.$el.hasClass("ul-site-publish--tariffexpired")||this.$el.removeAttr("disabled")},setPubished:function(){var e=this.getDateFormat();this.$el.attr("title",n("constructor.published")+" "+e),this.$el.removeClass("icon-content-special-publish").addClass("icon-content-special-check ul-site-publish--published").attr("disabled","disabled")},checkPublishDate:function(){this.date=this.$el.attr("data-date"),this.$el.hasClass("ul-site-publish--published")?this.setPubished():this.setPubish()},publish:function(){var e=this;if(e.$el.attr("disabled")){if(!e.$el.hasClass("ul-site-publish--tariffexpired")){var t;try{t=JSON.parse(localStorage.publishCongrats)}catch(r){}if(t&&t[o.params.site]){var n=o.params?o.params.siteMainDomain||o.params.siteDomain:window.siteDomain;window.open("http://"+n)}else require(["publishedWindow"],function(e){e.init(o.params.site)})}}else{e.$el.attr("disabled","disabled").addClass("disabled"),e._publishTimer&&(clearTimeout(e._publishTimer),delete e._publishTimer);var a=function(){e.$el.hasClass("ul-site-publish--tariffexpired")||(e.$el.removeAttr("disabled"),clearTimeout(e._publishTimer),delete e._publishTimer),e.$el.removeClass("disabled"),f.hide()};u.publish(o.params.site,function(){v.counterCheck(!0)},a,a)}},publishLoader:function(){var e=this;e._publishTimer||(e._publishTimer=setTimeout(function(){v._longPublication=!0,f.show({isBlurring:!1,isShowPanel:!1,isShowProgressBar:!0,img:!1,title:"publication.title",text:"publication.text"},{renderIfExist:!1})},0))},setPublishDate:function(e){var t=this;t.date=e,t.$el.attr("data-date",t.date)},getDateFormat:function(){return"ru"===d.get()&&p.locale("ru",{calendar:{sameDay:"[сегодня в] LT",nextDay:"[завтра в] LT",lastDay:"[вчера в] LT",nextWeek:function(){return 2===this.day()?"[во] dddd [в] LT":"[в] dddd [в] LT"},lastWeek:function(){switch(this.day()){case 0:return"[в прошлое] dddd [в] LT";case 1:case 2:case 4:return"[в прошлый] dddd [в] LT";case 3:case 5:case 6:return"[в прошлую] dddd [в] LT"}},sameElse:"L"}}),p(this.date).calendar()},showTooltip:function(t){var r=e("#ul-publish-tooltip");if(!r.hasClass("active")&&r.length){var a=function(t){t.preventDefault(),r.removeClass("active ul-publish-tooltip-active ready").off("click"),e(document).off("click.tooltipPublich"),window.analyticsHandler("facebookPixel.mainId",null,"track","Prompt"),e.ajax({url:"/sites/url/"+o.params.site+"/tooltipShown",method:"post",api:!0,ok:function(){},noOk:function(){console.warn("Failed tooltipShown request")}})};e(".js-site-publish",r).removeClass("icon-content-special-check ul-site-publish--published").addClass("icon-content-special-publish"),r.addClass("active ul-publish-tooltip-active"),e(document).on("click.tooltipPublich",a),t>0&&r.find(".js-publish-tooltip-puttext").text(n("constructor.publish again tooltip")),setTimeout(function(){r.addClass("ready")},500)}}},_loadPanel:function(e){var t=this;return _asyncToGenerator(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.oldPanel=t.panels.current,t.panels[t.panels.current]&&t.panels[t.panels.current].deinit(v),t.panels.current=null,!t.panels[e]){r.next=7;break}r.t0=t.panels[e],r.next=10;break;case 7:return r.next=9,new Promise(function(t){return require([e],function(e){return t(e)})});case 9:r.t0=r.sent;case 10:return n=r.t0,t.panels[e]||(v.$content.addClass("ul-loading-indicator"),t.panels[e]=n,v.$content.removeClass("ul-loading-indicator")),o.params.panelCurrent=e,t.panels.current=e,t._switchActive(e),n.$el=t.$content.find('[data-target="'.concat(e,'"]')),n.visibleClass=t.visibleClass,r.next=19,n.init(t);case 19:case"end":return r.stop()}},r)}))()},_loadAll:function(){var e=this;require(["panelConstructor","panelPages","panelDesign","panelPreview","panelDevice","panelHelp"],function(t,o,r,n,a,i){e.panels.panelConstructor=t,e.panels.panelPages=o,e.panels.panelDesign=r,e.panels.panelPreview=n,e.panels.panelDevice=a,e.panels.panelHelp=i})},_historyBtnsLight:function(){r.states.length?this.$undo.removeAttr("disabled"):this.$undo.attr("disabled","disabled"),r.forwardStates.length?this.$redo.removeAttr("disabled"):this.$redo.attr("disabled","disabled")},dropRemoveEl:{show:function(){e(".ul-drop-remove").removeClass("ul-drop-remove-hide")},hide:function(){e(".ul-drop-remove").addClass("ul-drop-remove-hide")}},_switchActive:function(e){v.$main.find('.js-panel-action[data-action="panel"]').removeClass("active").end().find('.js-panel-action[data-panel="'+e+'"]').addClass("active"),v.$content.find("[data-target]").removeClass(this.visibleClass).end().find('[data-target="'+e+'"]').addClass(this.visibleClass)},blockRemove:function(t){var r=t.attr("data-id");e.ajax({url:"/api/blanks/site/"+o.params.site+"/removeBlock/"+r+"/",type:"get",success:function(){t.animate({height:0},500,"linear",function(){e(this).remove()})}})},favoriteBlockRemove:function(t,r){e.ajax({url:"/sites/url/"+o.params.site+"/favoriteBlocks/"+t,type:"delete",api:!0,ok:function(){r()},noOk:function(){i.notify(n("constructor.favorite-blocks.block favorites remove error"),"error")}})},favoriteBlockEdit:function(t,r){e.ajax({url:"/sites/url/"+o.params.site+"/favoriteBlocks/"+t.id,type:"put",data:{title:t.title},api:!0,ok:function(e){r(e)},noOk:function(){i.notify(n("constructor.favorite-blocks.block favorites edit error"),"error")},error:function(e){if(500===e.status)throw new Error(e.responseText)}})},showPanel:function(){e(".ul-menu-btn-hidden").removeClass("rotate-arrow"),e("body").removeClass("ul-left-panel-hide"),e("#body").removeClass("ul-left-panel-hide"),this._hidePanel=!1,e(window).trigger("resize").trigger("resizeAllWidgets").trigger("colResized",e("#ul-content")),require(["cropModes"],function(e){e.recalcAll()}),window.analyticsHandler("yandexMetrika.mainId","reachGoal","client--panel-show"),window.dispatch(window.actions.toogleShowMenu(!0))},hidePanel:function(){e(".ul-menu-btn-hidden").addClass("rotate-arrow"),e("body").addClass("ul-left-panel-hide"),e("#body").addClass("ul-left-panel-hide"),this._hidePanel=!0,e(window).trigger("resize").trigger("resizeAllWidgets").trigger("colResized",e("#ul-content")),require(["cropModes"],function(e){e.recalcAll()}),window.analyticsHandler("yandexMetrika.mainId","reachGoal","client--panel-hide"),window.dispatch(window.actions.toogleShowMenu(!1))}};return v});
//# sourceMappingURL=app.build.js.map
